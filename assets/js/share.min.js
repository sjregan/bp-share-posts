!function(a,b,c,d){"use strict";function e(b,c){this.element=b,this.settings=a.extend({},g,c),this._defaults=g,this._name=f,this.$container=a(b),this.shareIcon=this.$container.data("share-icon"),this.sharedIcon=this.$container.data("shared-icon"),this.shareLabel=this.$container.data("share-label"),this.sharedLabel=this.$container.data("shared-label"),this.itemId=parseInt(this.$container.data("item-id")),this.type=this.$container.data("type"),this.init()}var f="bpSharePostsButton",g={};a.extend(e.prototype,{init:function(){this.$container.on("click",this.shareClicked.bind(this))},shareClicked:function(a){if(a.preventDefault(),!this.$container.hasClass("bp-share-posts-loading")){this.$container.addClass("bp-share-posts-loading");var b=this,c="shared"===this.$container.data("status")?"":"share",d={action:"bp_share_post",type:this.type,item_id:this.itemId,status:c};jQuery.post(ajaxurl,d,function(a){a&&a.success&&("share"===c?b.markAsShared():b.markAsUnshared())},"json").always(function(){b.$container.removeClass("bp-share-posts-loading")})}},markAsShared:function(){if(this.$container.data("status","shared"),this.$container.addClass("bp-share-posts-shared"),this.sharedIcon.length){var a=jQuery(this.sharedIcon);this.$container.find(".bp-share-posts-icon").remove(),this.$container.prepend(a)}this.sharedLabel.length&&this.$container.find(".bp-share-posts-label").html(this.sharedLabel)},markAsUnshared:function(){if(this.$container.data("status",""),this.$container.removeClass("bp-share-posts-shared"),this.shareIcon.length){var a=jQuery(this.shareIcon);this.$container.find(".bp-share-posts-icon").remove(),this.$container.prepend(a)}this.shareLabel.length&&this.$container.find(".bp-share-posts-label").html(this.shareLabel)}}),a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))})}}(jQuery,window,document);